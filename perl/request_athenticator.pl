#!/usr/bin/env perl
use Digest::MD5 qw(md5 md5_hex md5_base64);

@msg = (0x28, 0x02, 0x00, 0x34,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x01, 0x0d,
0x31, 0x35, 0x38, 0x30, 0x31, 0x35, 0x33, 0x34,
0x31, 0x31, 0x38, 0x2c, 0x13, 0x35, 0x36, 0x39,
0x33, 0x44, 0x31, 0x41, 0x44, 0x2d, 0x30, 0x30,
0x30, 0x36, 0x37, 0x34, 0x45, 0x31
);
$msg_pack = pack("C*", @msg);
print unpack("H*", $msg_pack);

$password="cmedia";
print "\n";
print unpack("H*", $password);

$authenticator = md5($msg_pack, $password);

print "\n";
print unpack("H*", $authenticator);
